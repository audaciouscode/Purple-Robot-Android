(function(){function b(a){a=a||{};this.className="PurpleRobot";this._serverUrl=a.serverUrl||"http://localhost:12345/json/submit";this._script=a.script||""}function e(a,b,c){this.methodName=a;this.argument=b;this.expectedArgument=c;this.message=' received an unexpected argument "';this.toString=function(){return["PurpleRobot.",this.methodName,this.message,this.argument,'" expected: ',this.expectedArgument].join("")}}function c(a){return"'"+a+"'"}var f=window;b.apiVersion="1.5.12.0";b.setEnvironment=
function(a){if("production"!==a&&"debug"!==a&&"web"!==a)throw new e("setEnvironment",a,'["production", "debug", "web"]');this.env=a;return this};b.prototype._push=function(a,c){var d=["PurpleRobot.",a,"(",c,");"].join("");return new b({serverUrl:this._serverUrl,script:[this._script,d].join(" ").trim()})};b.prototype._stringify=function(a){return null!==a&&"object"===typeof a&&a.className===this.className?a.toStringExpression():JSON.stringify(a)};b.prototype.toString=function(){return this._script};
b.prototype.toStringExpression=function(){return"(function() { return "+this._script+" })()"};b.prototype.toJson=function(){return JSON.stringify(this.toString())};b.prototype.execute=function(a){var c=JSON.stringify({command:"execute_script",script:this.toString()});if("web"!==b.env){var d=new XMLHttpRequest;d.onreadystatechange=function(){a&&d.readyState===XMLHttpRequest.DONE&&(null===d.response?a.fail&&a.fail():a.done&&a.done(JSON.parse(d.response).payload))};d.open("POST",this._serverUrl,!0);
d.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8");d.send("json="+c)}else console.log('PurpleRobot POSTing to "'+this._serverUrl+'": '+c)};b.prototype.save=function(){localStorage.prQueue=localStorage.prQueue||"";localStorage.prQueue+=this.toString();return this};b.prototype.restore=function(){localStorage.prQueue=localStorage.prQueue||"";this._script=localStorage.prQueue;return this};b.prototype.destroy=function(){delete localStorage.prQueue;return this};b.prototype.isEqual=
function(a,c){var d=this._stringify(a)+" == "+this._stringify(c);return new b({serverUrl:this._serverUrl,script:[this._script,d].join(" ").trim()})};b.prototype.ifThenElse=function(a,c,d){return new b({serverUrl:this._serverUrl,script:[this._script,"if ("+a.toString()+") { "+c.toString()+" } else { "+d.toString()+" }"].join(" ").trim()})};b.prototype.doNothing=function(){return new b({serverUrl:this._serverUrl,script:this._script})};b.prototype.addNamespace=function(a){return this._push("addNamespace",
""+c(a))};b.prototype.broadcastIntent=function(a,b){return this._push("broadcastIntent",[c(a),JSON.stringify(b||null)].join(", "))};b.prototype.cancelScriptNotification=function(){return this._push("cancelScriptNotification")};b.prototype.clearNativeDialogs=function(a){return a?this._push("clearNativeDialogs",c(a)):this._push("clearNativeDialogs")};b.prototype.clearTriggers=function(){return this._push("clearTriggers")};b.prototype.dateFromTimestamp=function(a){return this._push("dateFromTimestamp",
a)};b.prototype.deleteTrigger=function(a){return this._push("deleteTrigger",c(a))};b.prototype.disableTrigger=function(a){return this._push("disableTrigger",c(a))};b.prototype.emitReading=function(a,b){return this._push("emitReading",c(a)+", "+JSON.stringify(b))};b.prototype.emitToast=function(a,b){b="boolean"===typeof b?b:!0;return this._push("emitToast",c(a)+", "+b)};b.prototype.enableTrigger=function(a){return this._push("enableTrigger",c(a))};b.prototype.fetchConfig=function(){return this._push("fetchConfig")};
b.prototype.fetchEncryptedString=function(a,b){return"undefined"===typeof b?this._push("fetchEncryptedString",c(a)):this._push("fetchEncryptedString",c(b)+", "+c(a))};b.prototype.fetchNamespace=function(a){return this._push("fetchNamespace",""+c(a))};b.prototype.fetchNamespaces=function(){return this._push("fetchNamespaces")};b.prototype.fetchTrigger=function(a){return this._push("fetchTrigger",""+c(a))};b.prototype.fetchTriggerIds=function(){return this._push("fetchTriggerIds")};b.prototype.fetchUserId=
function(){return this._push("fetchUserId")};b.prototype.fetchWidget=function(a){throw Error("PurpleRobot.prototype.fetchWidget not implemented yet");};b.prototype.fireTrigger=function(a){return this._push("fireTrigger",c(a))};b.prototype.formatDate=function(a){throw Error("PurpleRobot.prototype.formatDate not implemented yet");};b.prototype.launchApplication=function(a){return this._push("launchApplication",c(a))};b.prototype.launchInternalUrl=function(a){return this._push("launchInternalUrl",""+
c(a))};b.prototype.launchUrl=function(a){return this._push("launchUrl",c(a))};b.prototype.loadLibrary=function(a){throw Error("PurpleRobot.prototype.loadLibrary not implemented yet");};b.prototype.log=function(a,b){return this._push("log",c(a)+", "+JSON.stringify(b))};b.prototype.models=function(){throw Error("PurpleRobot.prototype.models not implemented yet");};b.prototype.now=function(){return this._push("now")};b.prototype.packageForApplicationName=function(a){return this._push("packageForApplicationName",
""+c(a))};b.prototype.parseDate=function(a){throw Error("PurpleRobot.prototype.parseDate not implemented yet");};b.prototype.persistEncryptedString=function(a,b,d){return"undefined"===typeof d?this._push("persistEncryptedString",c(a)+", "+c(b)):this._push("persistEncryptedString",c(d)+", "+c(a)+", "+c(b))};b.prototype.playDefaultTone=function(){return this._push("playDefaultTone")};b.prototype.playTone=function(a){return this._push("playTone",c(a))};b.prototype.predictions=function(){throw Error("PurpleRobot.prototype.predictions not implemented yet");
};b.prototype.readings=function(){throw Error("PurpleRobot.prototype.readings not implemented yet");};b.prototype.readUrl=function(a){return this._push("readUrl",c(a))};b.prototype.resetTrigger=function(a){return this._push("resetTrigger",c(a))};b.prototype.runScript=function(a){return this._push("runScript",a.toJson())};b.prototype.scheduleScript=function(a,b,d){b="(function() { var now = new Date(); var scheduled = new Date(now.getTime() + "+b+" * 60000); var pad = function(n) { return n < 10 ? '0' + n : n; }; return '' + scheduled.getFullYear() + pad(scheduled.getMonth() + 1) + pad(scheduled.getDate()) + 'T' + pad(scheduled.getHours()) + pad(scheduled.getMinutes()) + pad(scheduled.getSeconds()); })()";
return this._push("scheduleScript",c(a)+", "+b+", "+d.toJson())};b.prototype.setUserId=function(a){return this._push("setUserId",c(a))};b.prototype.showApplicationLaunchNotification=function(a){throw Error("PurpleRobot.prototype.showApplicationLaunchNotification not implemented yet");};b.prototype.showNativeDialog=function(a){var b=a.tag||null,d=a.priority||0;return this._push("showNativeDialog",[c(a.title),c(a.message),c(a.buttonLabelA),c(a.buttonLabelB),a.scriptA.toJson(),a.scriptB.toJson(),JSON.stringify(b),
d].join(", "))};b.prototype.showScriptNotification=function(a){a=a||{};return this._push("showScriptNotification",[c(a.title),c(a.message),a.isPersistent,a.isSticky,a.script.toJson()].join(", "))};b.prototype.updateConfig=function(a){return this._push("updateConfig",""+JSON.stringify(a))};b.prototype.updateTrigger=function(a){a=a||{};var b=(new Date).getTime(),b=a.triggerId||"TRIGGER-"+b;a=JSON.stringify({type:a.type||"datetime",name:b,identifier:b,action:a.script.toString(),datetime_start:a.startAt,
datetime_end:a.endAt,datetime_repeat:a.repeatRule||"FREQ=DAILY;INTERVAL=1"});return this._push("updateTrigger",c(b)+", "+a)};b.prototype.updateWidget=function(a){throw Error("PurpleRobot.prototype.updateWidget not implemented yet");};b.prototype.version=function(){return this._push("version")};b.prototype.vibrate=function(a){return this._push("vibrate",c(a||"buzz"))};b.prototype.widgets=function(){throw Error("PurpleRobot.prototype.widgets not implemented yet");};f.PurpleRobot=b}).call(this);
